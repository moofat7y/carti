import{u as F,H as G,r as x,e as M,f as V,j as e,I as _,b as l,J as D,K as E,x as J,w as T}from"./index-a646533f.js";import{B as U,I as $}from"./BreadCrumbs-b9ca7c48.js";const W=()=>{var b,v,y,N;const{register:p,handleSubmit:C,setValue:i,getValues:z,formState:{errors:m}}=F(),o=G(),[c,d]=x.useState([]),[u,h]=x.useState((b=o.state)!=null&&b.product?o.state.product.product_image:null),[k,g]=x.useState(!1),f=x.useRef(),{categories:S}=M(r=>r.category),j=V(),q=(r,s)=>{const{name:t,value:n}=s.target,a=[...c];a[r][t]=n,d(a)},B=(r,s,t)=>{const{value:n}=t.target,a=[...c];a[r].sizes[s]=n,d(a)},L=r=>{r.target.files.length>0&&h(r.target.files[0])},P=()=>{d([...c,{name:"#111111",sizes:[]}])},I=r=>{const s=[...c];s.splice(r,1),d(s)},A=r=>{const s=[...c];s[r].sizes.push(""),d(s)},O=(r,s)=>{const t=[...c];t[r].sizes.splice(s,1),d(t)},R=async r=>{var t;if(!u){f.current.classList.add("!border-red-500");return}const s=new FormData;s.append("name",r.name),s.append("description",r.description),s.append("category",+r.category),s.append("price",+r.price),s.append("discount",+r.discount),s.append("image",u),s.append("qty",r.qty),s.append("colors",JSON.stringify(c)),g(!0),(t=o.state)!=null&&t.product?(s.append("_method","PUT"),await j(J({id:o.state.product.id,data:s}))):await j(T({data:s})),g(!1)};return x.useEffect(()=>{var r,s;if((r=o==null?void 0:o.state)!=null&&r.product){const t=o.state.product;i("name",t.name),i("qty",t.qty),i("discount",t.discount),i("description",t.description),i("price",t.price),i("category",t.category_name[0].id);const n=(s=t.color_size)==null?void 0:s.map(a=>{var w;return{name:a==null?void 0:a.color,sizes:(w=a==null?void 0:a.size)==null?void 0:w.split(",")}});d(n)}},[]),e.jsxs("div",{className:"container ",children:[e.jsx(U,{links:[{text:"المنتجات",href:"/products"},{text:(v=o.state)!=null&&v.product?"تعديل المنتج":"اضافة منتج",href:"/add-product"}]}),e.jsxs("form",{onSubmit:C(R),className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"w-full lg:w-[56%] ",children:[e.jsx("div",{className:"flex items-center justify-center w-full mb-4",children:u?e.jsxs("div",{className:"w-full h-64 relative",children:[e.jsx(_,{onClick:()=>h(null),className:"absolute top-1 right-1 text-red-500 cursor-pointer"}),e.jsx("img",{src:u.length>0?`https://cartyi.com/storage/images/products/${(y=u[0])==null?void 0:y.image}`:URL.createObjectURL(u),className:"object-contain w-full h-full"})]}):e.jsxs("label",{ref:f,htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"SVG, PNG, JPG or GIF (MAX. 800x400px)"})]}),e.jsx("input",{onChange:r=>L(r),id:"dropzone-file",type:"file",className:"hidden"})]})}),e.jsx("div",{className:"mb-4",children:e.jsx(l.Input,{color:"purple",variant:"standard",label:"اسم المنتج",error:!!m.name,type:"text",...p("name",{required:!0})})}),e.jsx("div",{className:"mb-4",children:e.jsx(l.Textarea,{variant:"standard",color:"purple",label:"تفاصيل المنتج",error:!!m.description,...p("description",{required:!0,minLength:{value:10,message:"يجب كتابة ملخص لا يقل عن عشرة احرف"}})})}),e.jsx("div",{className:"mb-3",children:e.jsx(l.Select,{color:"purple",...p("category",{required:!0}),onChange:r=>i("category",r),error:!!m.category,arrow:!1,variant:"standard",label:"اختر الفئه",className:"!flex ",children:S.map(r=>e.jsx(l.Option,{style:{right:"0px",left:"unset"},value:r.id.toString(),children:r.name},r.id))})}),e.jsx("div",{className:"mb-4",children:e.jsx(l.Input,{color:"purple",variant:"standard",label:"السعر",type:"number",error:!!m.price,...p("price",{required:!0})})}),e.jsx("div",{className:"mb-4",children:e.jsx(l.Input,{color:"purple",variant:"standard",label:"الكميه",type:"number",min:0,error:!!m.qty,...p("qty",{required:!0})})}),e.jsx("div",{className:"mb-4",children:e.jsx(l.Input,{color:"purple",variant:"standard",label:"التخفيض",type:"number",min:0,...p("discount",{})})})]}),e.jsxs("div",{className:"w-full lg:w-[40%]",children:[e.jsx("h3",{className:"text-3xl font-bold mb-4",children:"الالوان والمقاسات"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.map((r,s)=>e.jsxs("div",{className:"rounded-md shadow-md p-4 h-fit",children:[e.jsx("div",{className:"flex items-center gap-3 mb-3",children:e.jsx("input",{className:"px-1 rounded-md flex-shrink-0  mx-auto",type:"color",name:"name",value:r.name,onChange:t=>q(s,t)})}),e.jsx("h4",{className:"font-bold mb-2 ",children:"الاحجام"}),e.jsx("div",{className:"flex flex-wrap gap-2 ",children:r.sizes.map((t,n)=>e.jsxs("div",{className:"flex gap-2 items-center mb-2",children:[e.jsx(l.Input,{type:"text",value:t,color:"purple",placeholder:"الحجم",variant:"static",containerProps:{className:"!min-w-[20px] w-[40px]"},onChange:a=>B(s,n,a)}),e.jsx(l.IconButton,{type:"button",variant:"filled",color:"purple",className:"rounded-none flex-shrink-0",onClick:()=>O(s,n),children:e.jsx(D,{})})]},`${s}-${n}`))}),e.jsx(l.IconButton,{onClick:()=>A(s),color:"purple",className:" mx-auto",variant:"outlined",children:e.jsx($,{className:"text-[16px]"})}),e.jsx(l.Button,{onClick:()=>I(s),color:"purple",className:"d-block w-full mt-3",children:"حذف اللون"})]},s)),e.jsx("div",{className:"border border-dashed h-[212px] hover:border-purple-500 transition-colors rounded-md flex items-center justify-center",children:e.jsx(l.IconButton,{onClick:P,color:"purple",variant:"filled",children:e.jsx(E,{className:"text-xl"})})})]})]}),e.jsx(l.Button,{disabled:k,type:"submit",color:"purple",children:(N=o==null?void 0:o.state)!=null&&N.product?"تعديل المنتج":"اضافة المنتج"})]})]})};export{W as default};
